(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     17767,        401]
NotebookOptionsPosition[     17134,        376]
NotebookOutlinePosition[     17478,        391]
CellTagsIndexPosition[     17435,        388]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[{
 RowBox[{
  RowBox[{"givenDataUnNorm", " ", "=", " ", "myExampleData"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"precision", " ", "=", " ", "10"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"givenDataUnNorm", " ", "=", " ", 
  RowBox[{"(*", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"10", ",", "20", ",", "30", ",", "40", ",", "50"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "22", ",", "33", ",", "44", ",", "55"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"100", ",", "200", ",", "300", ",", "400", ",", "500"}], "}"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "6", ",", "8", ",", "10"}], "}"}]}], "}"}], 
   "*)"}], "\[IndentingNewLine]", 
  StyleBox[
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"11", ",", "33", ",", "22", ",", "44", ",", "55"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"6", ",", "7", ",", "8", ",", "9", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"66", ",", "77", ",", "88", ",", "99", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"2", ",", "4", ",", "6", ",", "8", ",", "0"}], "}"}]}], "}"}],
   FontVariations->{"Underline"->True}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"givenData", " ", "=", 
   RowBox[{"NormalizeMaxMin", "[", "givenDataUnNorm", "]"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TrainCount", "=", " ", 
   RowBox[{"IntegerPart", "[", 
    RowBox[{"0.8", "*", 
     RowBox[{"Length", "[", "givenData", "]"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getRequest", " ", ":=", " ", 
   RowBox[{
    RowBox[{"#", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", 
      RowBox[{"1", ";;", 
       RowBox[{"-", "2"}]}]}], "\[RightDoubleBracket]"}], "&"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"getAnswer", " ", ":=", " ", 
   RowBox[{
    RowBox[{"#", "\[LeftDoubleBracket]", 
     RowBox[{"All", ",", 
      RowBox[{
       RowBox[{"-", "1"}], ";;", 
       RowBox[{"-", "1"}]}]}], "\[RightDoubleBracket]"}], "&"}]}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"GetLearnedModelLeastSquares", "[", 
    RowBox[{"Request_", ",", "Asnwer_", ",", "precision_"}], "]"}], " ", ":=", 
   RowBox[{"Module", "[", 
    RowBox[{
     RowBox[{"{", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"N", "[", 
      RowBox[{
       RowBox[{"LeastSquares", "[", 
        RowBox[{"Request", ",", "Asnwer"}], "]"}], ",", " ", "precision"}], 
      "]"}]}], "\[IndentingNewLine]", "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"ApplyLearnedModelLeastSquares", "[", 
     RowBox[{"Request_", ",", " ", "LeastSquaresModel_"}], "]"}], ":=", 
    RowBox[{"Module", "[", 
     RowBox[{
      RowBox[{"{", "}"}], ",", 
      RowBox[{"Request", ".", "LeastSquaresModel"}]}], "]"}]}], ";"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"GetLearnedModel", " ", "=", " ", "GetLearnedModelLeastSquares"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ApplyLearnedModel", " ", "=", "ApplyLearnedModelLeastSquares"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"TestTimes", " ", "=", " ", "10"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6091644193933516`*^9, 3.6091645178029103`*^9}, {
   3.6091645518335805`*^9, 3.609164773161024*^9}, {3.609164805545598*^9, 
   3.6091648851976547`*^9}, {3.6091650460528135`*^9, 
   3.6091650506678934`*^9}, {3.6091652202798834`*^9, 
   3.6091656246572723`*^9}, {3.6091656687986755`*^9, 3.609165702669238*^9}, {
   3.6091673629077234`*^9, 3.609167419695548*^9}, {3.6091674988933077`*^9, 
   3.6091675008666277`*^9}, 3.6091675311427975`*^9, {3.609167561864262*^9, 
   3.6091675624726677`*^9}, {3.609167933160613*^9, 3.6091679804010844`*^9}, 
   3.6091681062519207`*^9, {3.609168290342698*^9, 3.609168417500409*^9}, {
   3.609169730517753*^9, 3.6091698024436655`*^9}, {3.609169871560708*^9, 
   3.6091698837838526`*^9}, {3.6091699809555855`*^9, 3.609169993276794*^9}, {
   3.6091700361193347`*^9, 3.6091700427627554`*^9}, {3.609170074614975*^9, 
   3.6091701240649223`*^9}, {3.6091713243565245`*^9, 
   3.6091713285993567`*^9}, {3.6091713791160107`*^9, 
   3.6091713812374215`*^9}, {3.609253119824319*^9, 3.609253134164876*^9}, 
   3.6092531915971365`*^9, {3.609254220116313*^9, 3.609254263204017*^9}, {
   3.6092546107015066`*^9, 3.6092546116411324`*^9}, {3.609321387239378*^9, 
   3.609321460121931*^9}, {3.609321529358056*^9, 3.6093215313994164`*^9}, {
   3.609322338252924*^9, 3.609322366605813*^9}, 3.6093249599584475`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "2", ",", "3", ",", "4", ",", "5"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"11", ",", "33", ",", "22", ",", "44", ",", "55"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"6", ",", "7", ",", "8", ",", "9", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"66", ",", "77", ",", "88", ",", "99", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"2", ",", "4", ",", "6", ",", "8", ",", "0"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6093213939688635`*^9, 3.609321464714993*^9, 
  3.609322367679529*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", 
     FractionBox["1", "11"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["2", "13"], ",", 
     FractionBox["31", "75"], ",", 
     FractionBox["19", "85"], ",", 
     FractionBox["8", "19"], ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "13"], ",", 
     FractionBox["1", "15"], ",", 
     FractionBox["1", "17"], ",", 
     FractionBox["1", "19"], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"1", ",", "1", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "65"], ",", 
     FractionBox["2", "75"], ",", 
     FractionBox["3", "85"], ",", 
     FractionBox["4", "95"], ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6093213939688635`*^9, 3.609321464714993*^9, 
  3.609322367686533*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"TestErrorList", " ", "=", " ", 
   RowBox[{"{", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Do", "[", "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"rndPerm", " ", "=", " ", 
     RowBox[{"PermutationList", "[", 
      RowBox[{
       RowBox[{"RandomPermutation", "[", 
        RowBox[{"Length", "[", "givenData", "]"}], "]"}], ",", 
       RowBox[{"Length", "[", "givenData", "]"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"TrainPart", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"givenData", "\[LeftDoubleBracket]", 
        RowBox[{
        "rndPerm", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", "TrainCount"}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"TestPart", " ", "=", " ", 
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"givenData", "\[LeftDoubleBracket]", 
        RowBox[{
        "rndPerm", "\[LeftDoubleBracket]", "i", "\[RightDoubleBracket]"}], 
        "\[RightDoubleBracket]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", 
         RowBox[{"TrainCount", "+", "1"}], ",", 
         RowBox[{"Length", "[", "givenData", "]"}]}], "}"}]}], "]"}]}], ";", 
    "\[IndentingNewLine]", 
    RowBox[{"LearnedModel", " ", "=", " ", 
     RowBox[{"GetLearnedModel", "[", 
      RowBox[{
       RowBox[{"getRequest", "[", "TrainPart", "]"}], ",", " ", 
       RowBox[{"getAnswer", "[", "TrainPart", "]"}], ",", "precision"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"ResultAnswer", " ", "=", " ", 
     RowBox[{"ApplyLearnedModel", "[", 
      RowBox[{
       RowBox[{"getRequest", "[", "TestPart", "]"}], ",", "LearnedModel"}], 
      "]"}]}], ";", "\[IndentingNewLine]", 
    RowBox[{"AppendTo", "[", 
     RowBox[{"TestErrorList", ",", 
      RowBox[{"EuclideanDistance", "[", 
       RowBox[{"ResultAnswer", ",", " ", 
        RowBox[{"getAnswer", "[", "TestPart", "]"}]}], "]"}]}], " ", 
     "\[IndentingNewLine]", "]"}]}], "\[IndentingNewLine]", ",", 
   "\[IndentingNewLine]", 
   RowBox[{"{", "TestTimes", "}"}]}], "\[IndentingNewLine]", "]"}]}], "Input",
 CellChangeTimes->{{3.60916570582034*^9, 3.6091657622979603`*^9}, {
   3.6091660790990114`*^9, 3.609166083302812*^9}, {3.6091669641931076`*^9, 
   3.6091670236597238`*^9}, {3.609167361523796*^9, 3.6091674919767046`*^9}, {
   3.6091675788826*^9, 3.6091676154909887`*^9}, {3.6091676956383805`*^9, 
   3.6091677421123405`*^9}, {3.609167785178029*^9, 3.6091678162647347`*^9}, {
   3.6091678543060813`*^9, 3.6091679222423377`*^9}, {3.6091679988243523`*^9, 
   3.6091680867469296`*^9}, 3.6091683892766027`*^9, {3.6091698485623884`*^9, 
   3.609169933700105*^9}, 3.609170020006601*^9, {3.6091700528444767`*^9, 
   3.6091700643391294`*^9}, {3.609170152707999*^9, 3.6091701569648385`*^9}, {
   3.609259146854473*^9, 3.6092591470766163`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Median", "[", "TestErrorList", "]"}], "\[IndentingNewLine]", 
 RowBox[{"Mean", "[", "TestErrorList", 
  "]"}], "\[IndentingNewLine]", "TestErrorList"}], "Input",
 CellChangeTimes->{
  3.609165767825647*^9, {3.6091658002422447`*^9, 3.609165827604471*^9}, {
   3.609165875757553*^9, 3.60916589813846*^9}, {3.6091659605200167`*^9, 
   3.6091660646063566`*^9}, 3.6091660999248853`*^9, {3.6091668270367365`*^9, 
   3.6091668365921016`*^9}, {3.6091670292244306`*^9, 3.6091670503695145`*^9}, 
   3.609167424576803*^9, 3.609168064932396*^9, {3.609168134219555*^9, 
   3.609168154934354*^9}, {3.6092530975064554`*^9, 3.6092531011338725`*^9}}],

Cell[BoxData["0.09090909090909090909090909090909090909`9.035698817869992"], \
"Output",
 CellChangeTimes->{{3.609168065423724*^9, 3.6091681121688643`*^9}, {
   3.609168142872319*^9, 3.6091681553216124`*^9}, 3.6091701605892487`*^9, 
   3.6092531015221305`*^9, 3.609253145947725*^9, 3.609253204933015*^9, 
   3.609254286532558*^9}],

Cell[BoxData["0.1953557279203454630381730143497809859`8.902995089227076"], \
"Output",
 CellChangeTimes->{{3.609168065423724*^9, 3.6091681121688643`*^9}, {
   3.609168142872319*^9, 3.6091681553216124`*^9}, 3.6091701605892487`*^9, 
   3.6092531015221305`*^9, 3.609253145947725*^9, 3.609253204933015*^9, 
   3.6092542865385623`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0``10.077091503028218", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0``9.035698817869992", ",", "0``9.035698817869992", ",", 
   "0``10.077091503028218", ",", "0``10.077091503028218", ",", 
   "0``9.035698817869992", ",", "0``10.077091503028218", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0``10.077091503028218", ",", "0``10.077091503028218", ",", 
   "0``9.035698817869992", ",", "0``9.035698817869992", ",", 
   "0``10.077091503028218", ",", "0``9.035698817869992", ",", 
   "0``10.077091503028218", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0``10.077091503028218", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0``9.035698817869992", ",", "0``9.035698817869992", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0``10.077091503028218", ",", "0``9.035698817869992", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0``10.077091503028218", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0``9.035698817869992", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0``10.077091503028218", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0``10.077091503028218", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0``9.035698817869992", ",", "0``9.035698817869992", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0``9.035698817869992", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0``10.077091503028218", ",", "0``9.035698817869992", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0``10.077091503028218", ",", "0``10.077091503028218", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0``9.035698817869992", ",", "0``10.077091503028218", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0``10.077091503028218", ",", "0``9.035698817869992", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0``10.077091503028218", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0``9.035698817869992", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0``10.077091503028218", ",", "0``9.035698817869992", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0``9.035698817869992", ",", "0``10.077091503028218", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0``10.077091503028218", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0``10.077091503028218", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0``9.035698817869992", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0.09090909090909090909090909090909090909`9.510305465533191", ",", 
   "0``9.035698817869992", ",", 
   "0.18181818181818181818181818181818181818`9.641612907239438", ",", 
   "0``9.035698817869992", ",", 
   "0.85503369364909095910003575652556591578`10.222486439537846", ",", 
   "0``10.077091503028218"}], "}"}]], "Output",
 CellChangeTimes->{{3.609168065423724*^9, 3.6091681121688643`*^9}, {
   3.609168142872319*^9, 3.6091681553216124`*^9}, 3.6091701605892487`*^9, 
   3.6092531015221305`*^9, 3.609253145947725*^9, 3.609253204933015*^9, 
   3.609254286541564*^9}]
}, Open  ]],

Cell[BoxData["\[IndentingNewLine]"], "Input",
 CellChangeTimes->{{3.6091695172326636`*^9, 3.6091695260805564`*^9}, 
   3.6091696476195245`*^9}]
},
WindowSize->{707, 602},
WindowMargins->{{367, Automatic}, {Automatic, 8}},
FrontEndVersion->"9.0 for Microsoft Windows (64-bit) (January 25, 2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 4901, 113, 492, "Input"],
Cell[5483, 137, 601, 15, 52, "Output"],
Cell[6087, 154, 916, 27, 82, "Output"]
}, Open  ]],
Cell[7018, 184, 2976, 64, 332, "Input"],
Cell[CellGroupData[{
Cell[10019, 252, 658, 10, 72, "Input"],
Cell[10680, 264, 329, 5, 31, "Output"],
Cell[11012, 271, 330, 5, 31, "Output"],
Cell[11345, 278, 5627, 91, 356, "Output"]
}, Open  ]],
Cell[16987, 372, 143, 2, 52, "Input"]
}
]
*)

(* End of internal cache information *)
